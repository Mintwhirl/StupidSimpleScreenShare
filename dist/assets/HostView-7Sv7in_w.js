import{u as O,r as t,j as e}from"./main-yWA1bgRg.js";import{u as P,V as F,A as S}from"./useWebRTC-DYzIAOVT.js";function B({config:j,onGoHome:w}){console.log("HostView: Component is rendering");const{roomId:r,updateSenderSecret:u}=O();console.log("HostView: roomId =",r,"updateSenderSecret =",typeof u);const[a,m]=t.useState(!1),[n,y]=t.useState("disconnected"),[f,N]=t.useState(0),[g,i]=t.useState(null),[v,l]=t.useState("Start Sharing"),[d,h]=t.useState(null),c=t.useRef(null),{startScreenShare:C,stopScreenShare:E,connectionState:p,peerConnections:b,error:x}=P(r,"host",j);t.useEffect(()=>{y(p)},[p]),t.useEffect(()=>{N(Object.keys(b).length)},[b]),t.useEffect(()=>{x&&i(x)},[x]),t.useEffect(()=>{(async()=>{if(console.log("HostView: Attempting to register host sender for room:",r),!r){console.log("HostView: No roomId, skipping registration");return}try{console.log("HostView: Making registration request to:",S.REGISTER_SENDER);const o=await fetch(S.REGISTER_SENDER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:r,senderId:"host"})});if(console.log("HostView: Registration response status:",o.status),o.ok){const D=await o.json();console.log("HostView: Registration successful, secret received"),u(D.secret)}else console.warn("HostView: Failed to register host sender:",o.status)}catch(o){console.warn("HostView: Failed to register host sender:",o)}})()},[r,u]);const I=async()=>{try{i(null),l("Starting...");const s=await C();s&&c.current&&(c.current.srcObject=s,m(!0),l("Stop Sharing"))}catch(s){console.error("Error starting screen share:",s),i("Failed to start screen sharing. Please check your browser permissions."),l("Start Sharing")}},R=async()=>{try{await E(),c.current&&(c.current.srcObject=null),m(!1),l("Start Sharing")}catch(s){console.error("Error stopping screen share:",s),i("Failed to stop screen sharing.")}},V=()=>{a?R():I()},k=()=>{navigator.clipboard.writeText(r).then(()=>{h("success"),setTimeout(()=>h(null),2e3)}).catch(s=>{console.error("Failed to copy room ID:",s),h("error"),setTimeout(()=>h(null),2e3)})},H=t.useMemo(()=>{switch(n){case"connected":return"text-green-600";case"connecting":return"text-yellow-600";case"disconnected":return"text-red-600";default:return"text-gray-600"}},[n]),T=t.useMemo(()=>{switch(n){case"connected":return"Connected";case"connecting":return"Connecting...";case"disconnected":return"Disconnected";default:return"Unknown"}},[n]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"üñ•Ô∏è Screen Sharing Room"}),e.jsx("p",{className:"text-gray-600",children:"Share your screen with others. Viewers can join using the room ID below."})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-sm font-medium ${H}`,children:["Status: ",T]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Viewers: ",f]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Room Information"}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Room ID"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:r,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-900 font-mono text-sm"}),e.jsx("button",{onClick:k,className:`px-4 py-2 text-white rounded-lg transition-colors ${d==="success"?"bg-green-600":d==="error"?"bg-red-600":"bg-blue-600 hover:bg-blue-700"}`,children:d==="success"?"Copied!":d==="error"?"Failed!":"Copy"})]})]})}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Share this room ID with others so they can view your screen."})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Screen Share Controls"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("button",{onClick:V,disabled:n==="connecting",className:`px-6 py-3 rounded-lg font-medium transition-colors ${a?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"} ${n==="connecting"?"opacity-50 cursor-not-allowed":""}`,children:n==="connecting"?"Connecting...":v}),a&&e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium",children:"Sharing Active"})]})]}),!a&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:'Click "Start Sharing" to begin sharing your screen with viewers.'})})]}),g&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-red-800 font-medium",children:"Error"}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:g})]})]})}),a&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Screen (Preview)"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{ref:c,className:"w-full max-w-2xl mx-auto rounded-lg border border-gray-200",muted:!0,autoPlay:!0,playsInline:!0}),e.jsx("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-xs",children:"You are sharing this screen"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"üìã Instructions"}),e.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[e.jsx("p",{children:'‚Ä¢ Click "Start Sharing" to begin screen sharing'}),e.jsx("p",{children:"‚Ä¢ Select the screen or application you want to share"}),e.jsx("p",{children:"‚Ä¢ Share the Room ID with viewers so they can join"}),e.jsx("p",{children:"‚Ä¢ Use the Chat feature to communicate with viewers"}),e.jsx("p",{children:`‚Ä¢ Click "Stop Sharing" when you're done`})]})]}),e.jsx("div",{className:"flex justify-center space-x-4",children:e.jsx("button",{onClick:w,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Back to Home"})})]})}export{B as default};
//# sourceMappingURL=HostView-7Sv7in_w.js.map
